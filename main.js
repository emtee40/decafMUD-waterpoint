!function(i){var s={};function o(t){if(s[t])return s[t].exports;var e=s[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=i,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(i,s,function(t){return e[t]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=9)}([function(t,e,i){function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 * Licensed under the MIT license.
 */void 0===String.prototype.endsWith&&(String.prototype.endsWith=function(t){var e=this.length-t.length;return!(e<0)&&this.lastIndexOf(t,e)===e}),void 0===String.prototype.substr_count&&(String.prototype.substr_count=function(t){for(var e=0,i=this.indexOf(t);-1!==i;)e++,i=this.indexOf(t,i+1);return e}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){for(void 0===e&&(e=0);e<this.length;e++)if(this[e]===t)return e;return-1}),function(r){var s=function t(e,i){for(var s in i){var o=i[s];if("object"!==u(o)||"nodeType"in o)e[s]=o;else if(void 0!==o.push){void 0===e[s]&&(e[s]=[]);for(var n=0;n<o.length;n++)e[s].push(o[n])}else void 0===e[s]&&(e[s]={}),"object"===u(e[s])&&t(e[s],o)}return e},h=function t(e){if(this.options={},s(this.options,t.options),void 0!==e){if("object"!==u(e))throw"The DecafMUD options argument must be an object!";s(this.options,e)}if(this.settings={},s(this.settings,t.settings),this.need=[],this.inbuf=[],this.telopt={},"autodetect"===this.options.language){var i=navigator.language?navigator.language:navigator.userLanguage;this.options.language=i.split("-",1)[0]}return this.id=++t.last_id,t.instances.push(this),this.debugString("Created new instance.","info"),"console"in r&&console.groupCollapsed&&(console.groupCollapsed("DecafMUD["+this.id+"] Provided Options"),console.dir(this.options),console.groupEnd()),"en"!==this.options.language&&this.options.load_language&&this.require("decafmud.language."+this.options.language),this.require("decafmud.interface."+this.options.interface),this.waitLoad(this.initSplash),this};h.instances=[],h.last_id=-1,h.version={major:0,minor:9,micro:1,flag:"beta",toString:function(){return this.major+"."+this.minor+"."+this.micro+(this.flag?"-"+this.flag:"")}},h.prototype.loaded=!1,h.prototype.connecting=!1,h.prototype.connected=!1,h.prototype.loadTimer=null,h.prototype.timer=null,h.prototype.connect_try=0,h.prototype.required=0,(h.plugins={Display:{},Encoding:{},Extra:{},Interface:{},Language:{},Socket:{},Storage:{},Telopt:{}}).Encoding.iso88591={proper:"ISO-8859-1",decode:function(t){return[t,""]},encode:function(t){return t}},h.plugins.Encoding.utf8={proper:"UTF-8",decode:function(e){try{return[decodeURIComponent(escape(e)),""]}catch(t){for(var i="",s=0,o=e.length,n=c2=c3=c4=0;s<o;)if((n=e.charCodeAt(s++))<128)i+=String.fromCharCode(n);else if(191<n&&n<224){if(o<=s+1)break;i+=String.fromCharCode((31&n)<<6|63&e.charCodeAt(s++))}else if(223<n&&n<240){if(o<=s+2)break;i+=String.fromCharCode((15&n)<<12|(63&e.charCodeAt(s++))<<6|63&e.charCodeAt(s++))}else if(239<n&&n<245){if(o<=s+3)break;i+=String.fromCharCode((10&n)<<18|(63&e.charCodeAt(s++))<<12|(63&e.charCodeAt(s++))<<6|63&e.charCodeAt(s++))}else i+=String.fromCharCode(n);return[i,e.substr(s)]}},encode:function(e){try{return unescape(encodeURIComponent(e))}catch(t){return console.dir(t),e}}},h.prototype.loaded_plugs={};h.ESC="",h.BEL="";var a=h.TN={IAC:"Ã¿",DONT:"Ã¾",DO:"Ã½",WONT:"Ã¼",WILL:"Ã»",SB:"Ãº",SE:"Ã°",IS:"\0",EORc:"Ã¯",GA:"Ã¹",BINARY:"\0",ECHO:"",SUPGA:"",STATUS:"",SENDLOC:"",TTYPE:"",EOR:"",NAWS:"",TSPEED:" ",RFLOW:"!",LINEMODE:'"',AUTH:"#",NEWENV:"'",CHARSET:"*",MSDP:"E",MSSP:"F",COMPRESS:"U",COMPRESSv2:"V",MSP:"Z",MXP:"[",ZMP:"]",CONQUEST:"^",ATCP:"Ãˆ",GMCP:"Ã‰"},d=function(t){var e=h.TN;switch(t){case e.IAC:return"IAC";case e.DONT:return"DONT";case e.DO:return"DO";case e.WONT:return"WONT";case e.WILL:return"WILL";case e.SB:return"SB";case e.SE:return"SE";case e.BINARY:return"TRANSMIT-BINARY";case e.ECHO:return"ECHO";case e.SUPGA:return"SUPPRESS-GO-AHEAD";case e.STATUS:return"STATUS";case e.SENDLOC:return"SEND-LOCATION";case e.TTYPE:return"TERMINAL-TYPE";case e.EOR:return"END-OF-RECORD";case e.NAWS:return"NEGOTIATE-ABOUT-WINDOW-SIZE";case e.TSPEED:return"TERMINAL-SPEED";case e.RFLOW:return"REMOTE-FLOW-CONTROL";case e.AUTH:return"AUTH";case e.LINEMODE:return"LINEMODE";case e.NEWENV:return"NEW-ENVIRON";case e.CHARSET:return"CHARSET";case e.MSDP:return"MSDP";case e.MSSP:return"MSSP";case e.COMPRESS:return"COMPRESS";case e.COMPRESSv2:return"COMPRESSv2";case e.MSP:return"MSP";case e.MXP:return"MXP";case e.ZMP:return"ZMP";case e.CONQUEST:return"CONQUEST-PROPRIETARY";case e.ATCP:return"ATCP";case e.GMCP:return"GMCP"}return 15<(t=t.charCodeAt(0))?t.toString(16):"0"+t.toString(16)};h.debugIAC=function(t){for(var e="",i=h.TN,s=0,o=!1,n=t.length,r=d,a=0;a<n;a++){var l=t.charAt(a),c=l.charCodeAt(0);2!==s?3!==s&&4!==s?5!==s?(6===s?l===i.IAC||0<c&&c<8?(o&&(o=!1,e+='" '),l===i.IAC?(e+="IAC ",s=0):1===c?e+="REQUEST ":2===c?e+="ACCEPTED ":3===c?e+="REJECTED ":4===c?e+="TTABLE-IS ":5===c?e+="TTABLE-REJECTED ":6===c?e+="TTABLE-ACK ":7===c&&(e+="TTABLE-NAK ")):(o||(o=!0,e+='"'),e+=l):7===s?l===i.IAC||0===c?(o&&(o=!1,e+='" '),l===i.IAC?(e+="IAC ",s=0):0===c&&(e+="NUL ")):(o||(o=!0,e+='"'),e+=l):s<2&&(e+=r(l)+" "),0===s?l===i.SB&&(s=1):1===s&&(s=l===i.TTYPE||l===i.TSPEED?2:l===i.MSSP?3:l===i.MSDP?4:l===i.NAWS?5:l===i.CHARSET?6:l===i.SENDLOC?6:l===i.GMCP?6:l===i.ZMP?7:0)):l===i.IAC?(o=!1,e+="IAC ",s=0):o=!1===o?255*c:(e+=(c+o).toString()+" ",!1):l===i.IAC||1<=c&&c<=4?(o&&(o=!1,e+='" '),l===i.IAC?(e+="IAC ",s=0):3===c?e+="MSDP_OPEN ":4===c?e+="MSDP_CLOSE ":(e+=3===s?"MSSP_":"MSDP_",e+=1===c?"VAR ":"VAL ")):(o||(o=!0,e+='"'),e+=l):l===i.ECHO?e+="SEND ":l===i.IS?e+="IS ":l===i.IAC?(o?(o=!1,e+='" IAC '):e+="IAC ",s=0):(o||(o=!0,e+='"'),e+=l)}return e.substr(0,e.length-1)};var t=function(t){this.decaf=t};t.prototype.current=-1,t.prototype._dont=t.prototype.disconnect=function(){this.current=-1},t.prototype._sb=function(t){if(t===a.ECHO)return this.current=(this.current+1)%this.decaf.options.ttypes.length,this.decaf.debugString("RCVD "+h.debugIAC(a.IAC+a.SB+a.TTYPE+a.ECHO+a.IAC+a.SE)),this.decaf.sendIAC(a.IAC+a.SB+a.TTYPE+a.IS+this.decaf.options.ttypes[this.current]+a.IAC+a.SE),!1},h.plugins.Telopt[a.TTYPE]=t;var e=function(t){this.decaf=t};e.prototype._will=function(){this.decaf.ui&&this.decaf.ui.localEcho(!1)},e.prototype._wont=e.prototype.disconnect=function(){this.decaf.ui&&this.decaf.ui.localEcho(!0)},h.plugins.Telopt[a.ECHO]=e;var i=function(t){this.decaf=t};i.prototype.enabled=!1,i.prototype.last=void 0,i.prototype._do=function(){this.last=void 0,this.enabled=!0;var t=this;setTimeout(function(){t.send()},0)},i.prototype._dont=i.prototype.disconnect=function(){this.enabled=!1},i.prototype.send=function(){if(this.decaf.display&&this.enabled){var t=this.decaf.display.getSize();if(void 0===this.last||this.last[0]!=t[0]||this.last[1]!=t[1]){this.last=t;var e=String.fromCharCode(Math.floor(t[0]/255));e+=String.fromCharCode(t[0]%255),e+=String.fromCharCode(Math.floor(t[1]/255)),e+=String.fromCharCode(t[1]%255),e=a.IAC+a.SB+a.NAWS+e.replace(/\xFF/g,"Ã¿Ã¿")+a.IAC+a.SE,this.decaf.sendIAC(e)}}},h.plugins.Telopt[a.NAWS]=i;var o=function(t){this.decaf=t};o.prototype._dont=function(){return!1},o.prototype._will=function(){var n=this;setTimeout(function(){var t=[],e=[];"iso88591"!==(s=this.decaf.options.encoding)&&void 0!==h.plugins.Encoding[s]&&void 0!==h.plugins.Encoding[s].proper&&(t.push(h.plugins.Encoding[s].proper),e.push(s));for(var i=0;i<this.decaf.options.encoding_order.length;i++){var s=this.decaf.options.encoding_order[i];void 0!==h.plugins.Encoding[s]&&void 0!==h.plugins.Encoding[s].proper&&-1===e.indexOf(s)&&(t.push(h.plugins.Encoding[s].proper),e.push(s))}for(var o in h.plugins.Encoding)-1===e.indexOf(o)&&void 0!==h.plugins.Encoding[o].proper&&t.push(h.plugins.Encoding[o].proper);n.decaf.sendIAC(a.IAC+a.SB+a.CHARSET+a.ECHO+" "+t.join(" ")+a.IAC+a.SE)},0)},o.prototype._sb=function(t){if(this.decaf.debugString("RCVD "+h.debugIAC(a.IAC+a.SB+a.CHARSET+t+a.IAC+a.SE)),1===t.charCodeAt(0)){0===(t=t.substr(1)).indexOf("TTABLE ")&&(t=t.substr(8));var e=t.charAt(0);t=t.substr(1).split(e);for(var i,s=void 0,o=0;o<t.length;o++){for(var n in i=t[o],h.plugins.Encoding)if(i===n||i===h.plugins.Encoding[n].proper){s=n;break}if(s)break}void 0!==s?(this.decaf.setEncoding(s),this.decaf.sendIAC(a.IAC+a.SB+a.CHARSET+""+i+a.IAC+a.SE)):(this.decaf.debugString("No encoder for: "+t.join(e)),this.decaf.sendIAC(a.IAC+a.SB+a.CHARSET+""+a.IAC+a.SE))}else if(2===t.charCodeAt(0)){t=t.substr(1);s=void 0;for(var n in h.plugins.Encoding)if(h.plugins.Encoding[n].proper===t){s=n;break}void 0!==s&&this.decaf.setEncoding(s)}return!1},h.plugins.Telopt[a.CHARSET]=o;var l=/[\x01\x02\x03\x04]/,c=function t(e){for(var i={},s=void 0;0<e.length;){var o=e.charCodeAt(0);if(1!==o){if(4===o){e=e.substr(1);break}if(void 0===s)return[i,""];if(2!==o)break;if(3===e.charCodeAt(1)){var n=t(e.substr(2));r=n[0],e=n[1]}else{var r="";e=-1===(a=e.substr(1).search(l))?(r=e.substr(1),""):(r=e.substr(1,a),e.substr(a+1))}void 0===i[s]?i[s]=r:"object"===u(i[s])&&void 0!==i[s].push?i[s].push(r):i[s]=[i[s],r]}else{var a;e=-1===(a=e.substr(1).search(l))?(s=e.substr(1),""):(s=e.substr(1,a),e.substr(a+1)),i[s]=void 0}}return[i,e]},p=function(t){this.decaf=t};p.prototype.connect=function(){this.commands=["LIST"],this.variables=[],this.reportable=[]},p.config_vars={CLIENT_NAME:"decafmud",CLIENT_VERSION:h.version.toString(),PLUGIN_ID:"0",ANSI_COLORS:"1",UTF_8:"1",XTERM_256_COLORS:"1"},p.prototype._will=function(){var t=this;setTimeout(function(){t.decaf.sendIAC(a.IAC+a.SB+a.MSDP+"LISTCOMMANDS"+a.IAC+a.SE),t.decaf.sendIAC(a.IAC+a.SB+a.MSDP+"LISTVARIABLES"+a.IAC+a.SE),t.decaf.sendIAC(a.IAC+a.SB+a.MSDP+"LISTCONFIGURABLE_VARIABLES"+a.IAC+a.SE),t.decaf.sendIAC(a.IAC+a.SB+a.MSDP+"LISTREPORTABLE_VARIABLES"+a.IAC+a.SE)},0)},p.prototype._sb=function(t){var e=c(t)[0],i=!1;if("console"in r&&console.groupCollapsed?(console.groupCollapsed("DecafMUD["+this.decaf.id+"]: RCVD IAC SB MSDP ... IAC SE"),console.dir(e),console.groupEnd("DecafMUD["+this.decaf.id+"]: RCVD IAC SB MSDP ... IAC SE")):i=!0,void 0!==e.COMMANDS)for(var s=0;s<e.COMMANDS.length;s++)this.commands.push(e.COMMANDS[s]);if(void 0!==e.VARIABLES)for(s=0;s<e.VARIABLES.length;s++)this.variables.push(e.VARIABLES[s]);if(void 0!==e.CONFIGURABLE_VARIABLES){var o=e.CONFIGURABLE_VARIABLES,n={};for(s=0;s<o.length;s++)void 0!==p.config_vars[o[s]]&&(n[o[s]]=p.config_vars[o[s]]);this.decaf.sendIAC(a.IAC+a.SB+a.MSDP+function t(e){var i=u(e);if("string"===i||"number"===i)return e.toString();if("boolean"===i)return e?"1":"0";if("undefined"===i)return"";if("object"!==i)return e.toString();var s="";for(var o in e)if(void 0!==e[o]&&null!==e[o]&&"function"!=typeof e[o])if(s+=""+o,"object"===u(e[o]))if(void 0!==e[o].push)for(var n=e[o],r=e[o].length,a=0;a<r;a++)s+=""+t(n[a]);else void 0===e[o].nodeType&&(s+=""+t(e[o])+"");else s+=""+t(e[o]);return s}(n)+a.IAC+a.SE)}return i},h.plugins.Telopt[a.MSDP]=p,h.plugins.Telopt[a.BINARY]=!0,h.plugins.Telopt[a.MSSP]="console"in r,void 0===String.prototype.tr&&(String.logNonTranslated="console"in r,String.prototype.tr=function(){var t,i,e,s;if(i=0<arguments.length&&arguments[0]instanceof h?(t=arguments[0],1):(t=h.instances[h.instances.length-1],0),"en"===(s=t.options.language))e=this;else if(!h.plugins.Language[s]||!(e=h.plugins.Language[s][this])){if(String.logNonTranslated){var o=h.plugins.Language[s]&&void 0!==h.plugins.Language[s].English?h.plugins.Language[s].English:'"'+s+'"';console.warn("DecafMUD["+t.id+"] i18n: No "+o+" translation for: "+this.replace(/\n/g,"\\n"))}e=this}if(arguments.length-i==1&&"object"===u(arguments[i])){var n=arguments[i];for(var r in n)e=e.replace("{"+r+"}",n[r])}else{n=arguments;e=e.replace(/{(\d+)}/g,function(t){var e=parseInt(t[1])+i;return e<n.length?n[e]:""})}return e}),h.prototype.about=function(){var t=["DecafMUD v{0} Â© 2010 Stendec"];t.push("http://decafmud.stendec.me/\n"),t.push("Updated and improved by Pit from Discworld."),t.push("Further bugfixes and improvements by Waba from MUME."),t.push("https://github.com/waba4mume/DecafMUD\n"),t.push("DecafMUD is a web-based MUD client written in JavaScript, rather than a plugin like Flash or Java, making it load faster and react as you'd expect a website to.\n"),t.push("It's easy to customize as well, using simple CSS and JavaScript, and free to use and modify, so long as your MU* is free to play!"),alert(t.join("\n").tr(this,h.version.toString()))},h.prototype.debugString=function(t,e,i){if(!(!1 in r)&&(void 0===e&&(e="debug"),void 0!==i&&(t=t.tr(this,i)),"console"in r)){var s="DecafMUD[%d]: %s";switch(e){case"info":return void console.info(s,this.id,t);case"warn":return void console.warn(s,this.id,t);case"error":return void console.error(s,this.id,t);default:if("debug"in console)return void console.debug(s,this.id,t);console.log(s,this.id,t)}}},h.prototype.error=function(t){this.debugString(t,"error"),"console"in r&&void 0!==console.groupCollapsed&&(console.groupCollapsed("DecafMUD["+this.id+"] Instance State"),console.dir(this),console.groupEnd()),this.ui&&this.ui.splashError(t)||alert("DecafMUD Error\n\n{0}".tr(this,t))},h.prototype.loadScript=function(t,e){if(void 0===e&&(void 0!==this.options.jslocation&&(e=this.options.jslocation),void 0===e||"string"==typeof e&&0===e.length)){var i=document.querySelector('script[src*="decafmud.js"]');null===i&&(i=document.querySelector('script[src*="decafmud.min.js"]')),null!==i&&(e=i.src.substr(0,i.src.lastIndexOf("/")+1))}var s=document.createElement("script");s.type="text/javascript",s.src=e+t,document.getElementsByTagName("head")[0].appendChild(s),this.debugString("Loading script: "+t)},h.prototype.require=function(t,e){this.options.load_language&&"en"!==this.options.language&&-1===t.indexOf("language")&&-1!==t.indexOf("decafmud")&&((i=t.split(".")).splice(1,0,"language",this.options.language),this.require(i.join(".")));if(void 0===e){if(0!==t.toLowerCase().indexOf("decafmud"))throw"Can't build checker for non-DecafMUD module!";var i;if((i=t.split(".")).length<2)return;if(i.shift(),i[0]=i[0][0].toUpperCase()+i[0].substr(1),"Telopt"===i[0])for(var s in h.TN)if(i[1].toUpperCase()===s.toUpperCase()){i[1]=h.TN[s];break}e=function(){return void 0!==h.plugins[i[0]]&&(!(1<i.length)||void 0!==h.plugins[i[0]][i[1]])}}this.required++,e.call(this)||(this.loadScript(t+".js"),this.need.push([t,e]))},h.prototype.waitLoad=function(t,e,i){if(clearTimeout(this.loadTimer),void 0===i)i=0;else if(i>this.options.wait_tries){if(-1===this.need[0][0].indexOf("language"))return void this.error("Timed out attempting to load the module: {0}".tr(this,this.need[0][0]));void 0!==e&&(1<this.need.length?e.call(this,this.need[0][0],this.need[1][0]):e.call(this,this.need[0][0])),this.need.shift(),i=0}for(;this.need.length;)if("string"==typeof this.need[0])this.need.shift();else{if(!this.need[0][1].call(this))break;void 0!==e&&(1<this.need.length?e.call(this,this.need[0][0],this.need[1][0]):e.call(this,this.need[0][0])),this.need.shift(),i=0}if(0===this.need.length)t.call(this);else{var s=this;this.loadTimer=setTimeout(function(){s.waitLoad(t,e,i+1)},this.options.wait_delay)}},h.prototype.initSplash=function(){void 0!==this.options.interface&&(this.debugString('Attempting to initialize the interface plugin "{0}".'.tr(this,this.options.interface)),this.ui=new h.plugins.Interface[this.options.interface](this),this.ui.initSplash()),this.extra=3,this.require("decafmud.storage."+this.options.storage),this.require("decafmud.socket."+this.options.socket),this.require("decafmud.encoding."+this.options.encoding),this.ui&&0<this.need.length&&this.updateSplash(null,this.need[0][0],0),this.waitLoad(this.initSocket,this.updateSplash)},h.prototype.updateSplash=function(t,e,i){if(this.ui){if(void 0===i&&(i=Math.min(100,Math.floor((this.extra+this.required-this.need.length)/(this.required+this.extra)*100))),!0===t);else if(void 0!==e)if(0===e.indexOf("decafmud")){var s=e.split(".");e='Loading the {0} module "{1}"...'.tr(this,s[1],s[2])}else e="Loading: {0}".tr(this,e);else 100==i&&(e="Loading complete.".tr(this));this.ui.updateSplash(i,e)}},h.prototype.initSocket=function(){this.extra=1,this.store=new h.plugins.Storage[this.options.storage](this),this.storage=this.store,this.ui&&(this.need.push("."),this.updateSplash(!0,"Initializing the user interface...".tr(this)),this.ui.load()),this.debugString('Creating a socket using the "{0}" plugin.'.tr(this,this.options.socket)),this.socket=new h.plugins.Socket[this.options.socket](this),this.socket.setup(0),this.waitLoad(this.initUI,this.updateSplash)},h.prototype.initUI=function(){this.ui&&this.ui.setup();for(var t=0;t<this.options.plugins.length;t++)this.require("decafmud."+this.options.plugins[t]);this.waitLoad(this.initFinal,this.updateSplash)},h.prototype.initFinal=function(){for(var t in this.need.push("."),this.updateSplash(!0,"Initializing triggers system..."),this.need.shift(),this.need.push("."),this.updateSplash(!0,"Initializing TELNET extensions..."),h.plugins.Telopt){var e=h.plugins.Telopt[t];this.telopt[t]="function"==typeof e?new e(this):e}this.loaded=!0,this.ui.endSplash(),this.options.autoconnect&&this.socket.ready&&this.connect()},h.prototype.connect=function(){if(!this.connecting&&!this.connected){if(!0!==this.socket_ready)throw"The socket isn't ready yet.";this.connecting=!0,this.connect_try=0,this.debugString("Attempting to connect...","info"),this.ui&&this.ui.connecting&&this.ui.connecting();var t=this;this.conn_timer=setTimeout(function(){t.connectFail()},this.options.connect_timeout),this.socket.connect()}},h.prototype.connectFail=function(){if(clearTimeout(this.conn_timer),this.cconnect_try+=1,!(this.connect_try>this.options.reconnect_tries)){this.socket.close(),this.socket.connect();var t=this;this.conn_timer=setTimeout(function(){t.connectFail()},this.options.connect_timeout)}},h.prototype.reconnect=function(){this.connect_try++;this.ui&&this.ui.connecting&&this.ui.connecting(),this.socket.connect()},h.prototype.socketReady=function(){this.debugString("The socket is ready."),this.socket_ready=!0,this.loaded&&this.options.autoconnect&&this.connect()},h.prototype.socketConnected=function(){this.connecting=!1,this.connected=!0,this.connect_try=0,clearTimeout(this.conn_timer);var t=this.socket.host,e=this.socket.port;for(var i in this.debugString("The socket has connected successfully to {0}:{1}.".tr(this,t,e),"info"),this.telopt)this.telopt[i]&&this.telopt[i].connect&&this.telopt[i].connect();this.ui&&this.ui.connected&&this.ui.connected()},h.prototype.socketClosed=function(){for(var t in clearTimeout(this.conn_timer),this.connecting=!1,this.connected=!1,this.debugString("The socket has disconnected.","info"),this.telopt)this.telopt[t]&&this.telopt[t].disconnect&&this.telopt[t].disconnect();if(this.inbuf=[],this.options.autoreconnect&&(this.connect_try++,this.connect_try<this.options.reconnect_tries)){this.ui&&this.ui.disconnected&&this.ui.disconnected(!0);var e=this,i=this.options.reconnect_delay/1e3;return this.ui&&this.ui.immediateInfoBar&&.25<=i&&this.ui.immediateInfoBar("You have been disconnected. Reconnecting in {0} second{1}...".tr(this,i,1===i?"":"s"),"reconnecting",i,void 0,[["Reconnect Now".tr(this),function(){clearTimeout(e.timer),e.socket.connect()}]],void 0,function(){clearTimeout(e.timer)}),void(this.timer=setTimeout(function(){e.debugString("Attempting to connect...","info"),e.ui&&e.ui.connecting&&e.ui.connecting(),e.socket.connect()},this.options.reconnect_delay))}this.ui&&this.ui.disconnected&&this.ui.disconnected(!1)},h.prototype.socketData=function(t){this.inbuf.push(t),this.loaded&&this.processBuffer()},h.prototype.socketError=function(t,e){this.debugString('Socket Err: {0}  d2="{1}"'.tr(this,t,e),"error")},h.prototype.getEnc=function(t){return t=t.replace(/-/g,"").toLowerCase()},h.prototype.setEncoding=function(t){if(t=this.getEnc(t),void 0===h.plugins.Encoding[t])throw'"'+t+"' isn't a valid encoding scheme, or it isn't loaded.";this.debugString("Switching to character encoding: "+t),this.options.encoding=t,this.decode=h.plugins.Encoding[t].decode,this.encode=h.plugins.Encoding[t].encode};var n=/\xFF/g;h.prototype.sendInput=function(t){this.socket&&this.socket.connected?(this.socket.write(this.encode(t+"\r\n").replace(n,"Ã¿Ã¿")),this.ui&&this.ui.displayInput(t)):this.debugString("Cannot send input: not connected")},h.prototype.decode=function(t){return h.plugins.Encoding[this.options.encoding].decode(t)},h.prototype.encode=function(t){return h.plugins.Encoding[this.options.encoding].encode(t)},h.prototype.processBuffer=function(){if(this.display){var t=this.inbuf.join(""),e=h.TN.IAC,i="";for(this.inbuf=[];0<t.length;){var s=t.indexOf(e);if(-1===s){var o=this.decode(t);this.display.handleData(o[0]),this.inbuf.splice(1,0,o[1]);break}if(0<s){o=this.decode(t.substr(0,s));this.display.handleData(o[0]),i=o[1],t=t.substr(s)}var n=this.readIAC(t);if(!1===n){this.inbuf.splice(1,0,i+t);break}t=i+n}}},h.prototype.readIAC=function(t){if(t.length<2)return!1;if(255===t.charCodeAt(1))return this.display.handleData("Ã¿"),t.substr(2);if(249===t.charCodeAt(1)||241===t.charCodeAt(1))return t.substr(2);if(-1!=="Ã»Ã¼Ã½Ã¾".indexOf(t.charAt(1))){if(t.length<3)return!1;var e=t.substr(0,3);return this.debugString("RCVD "+h.debugIAC(e)),this.handleIACSimple(e),t.substr(3)}if(t.charAt(1)===a.SB){e="";var i=a.IAC+a.SE,s=t.charAt(2);if(0===(t=t.substr(3)).length)return!1;for(;0<t.length;){var o=t.indexOf(i);if(-1===o)return!1;if(!(0<o&&t.charAt(o-1)===a.IAC)){e+=t.substr(0,o),t=t.substr(o+1);break}e+=t.substr(0,o+1),t=t.substr(o+1)}var n=!0;void 0!==this.telopt[s]&&void 0!==this.telopt[s]._sb&&!1===this.telopt[s]._sb(e)&&(n=!1),n&&(s===a.MSSP&&void 0!==console.groupCollapsed?(console.groupCollapsed("DecafMUD["+this.id+"]: RCVD IAC SB MSSP ... IAC SE"),console.dir(c(e)[0]),console.groupEnd("DecafMUD["+this.id+"]: RCVD IAC SB MSSP ... IAC SE")):this.debugString("RCVD "+h.debugIAC(a.IAC+a.SB+s+e+a.IAC+a.SE)))}return t.substr(1)},h.prototype.sendIAC=function(t){this.debugString("SENT "+h.debugIAC(t)),this.socket&&this.socket.write(t)},h.prototype.handleIACSimple=function(t){var e=h.TN,i=this.telopt[t.charAt(2)],s=t.charAt(2);if(void 0!==i)switch(t.charAt(1)){case e.DO:return void(i._do&&!1===i._do()||this.sendIAC(e.IAC+e.WILL+s));case e.DONT:return void(i._dont&&!1===i._dont()||this.sendIAC(e.IAC+e.WONT+s));case e.WILL:return void(i._will&&!1===i._will()||this.sendIAC(e.IAC+e.DO+s));case e.WONT:return void(i._wont&&!1===i._wont()||this.sendIAC(e.IAC+e.DONT+s))}else t.charAt(1)===e.DO?this.sendIAC(e.IAC+e.WONT+s):t.charAt(1)===e.WILL&&this.sendIAC(e.IAC+e.DONT+s)},h.prototype.requestPermission=function(t,e,i){var s=this.store.get(t);if(null==s){var o=this;this.ui&&this.ui.infoBar&&this.ui.infoBar(e,"permission",0,void 0,[["Allow".tr(this),function(){o.store.set(t,!0),i.call(o,!0)}],["Deny".tr(this),function(){o.store.set(t,!1),i.call(o,!1)}]],void 0,function(t){i.call(o,!1)})}else i.call(this,!!s)},h.settings={startup:{_path:"/",_desc:"Control what happens when DecafMUD is opened.",autoconnect:{_type:"boolean",_desc:"Automatically connect to the server."},autoreconnect:{_type:"boolean",_desc:"Automatically reconnect when the connection is lost."}},appearance:{_path:"display/",_desc:"Control the appearance of the client.",font:{_type:"font",_desc:"The font to display MUD output in."}}},h.options={host:void 0,port:4e3,autoconnect:!0,connectonsend:!0,autoreconnect:!0,connect_timeout:5e3,reconnect_delay:5e3,reconnect_tries:3,storage:"standard",display:"standard",encoding:"iso88591",socket:"flash",interface:"simple",language:"autodetect",jslocation:void 0,wait_delay:25,wait_tries:1e3,load_language:!0,plugins:[],set_storage:{},set_display:{handlecolor:!0,fgclass:"c",bgclass:"b",fntclass:"fnt",inputfg:"-7",inputbg:"-0"},set_socket:{policyport:void 0,swf:"/media/DecafMUDFlashSocket.swf",wsport:void 0,wspath:""},set_interface:{container:void 0,start_full:!1,mru:!0,mru_size:15,multiline:!0,clearonsend:!1,focusinput:!0,repeat_input:!0,blurclass:"mud-input-blur",msg_connect:"Press Enter to connect and type here...",msg_connecting:"DecafMUD is attempting to connect...",msg_empty:"Type commands here, or use the Up and Down arrows to browse your recently used commands.",connect_hint:!0},ttypes:["decafmud-"+h.version,"decafmud","xterm","unknown"],environ:{},encoding_order:["utf8"],plugin_order:[]},r.DecafMUD=h}(window)},function(t,e){
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 */
!function(s){var u=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):(e="on"+e,t.attachEvent?t.attachEvent(e,i):t[e]=i)},f=/Firefox\//.test(navigator.userAgent),t=function(t){var e=this;if(this.decaf=t,this.container=t.options.set_interface.container,"string"==typeof this.container&&(this.container=document.querySelector(this.container)),!("nodeType"in this.container))throw"The container must be a node in the DOM!";this.container.setAttribute("role","application"),this.container.className+=" decafmud mud interface",this.el_display=document.createElement("div"),this.el_display.className="decafmud mud-pane primary-pane",this.el_display.setAttribute("role","log"),this.el_display.setAttribute("aria-live","assertive"),this.el_display.setAttribute("tabIndex","0"),this.container.appendChild(this.el_display),u(this.el_display,"keydown",function(t){e.displayKey(t)}),this._input=document.createElement("div"),this._input.className="decafmud input-cont",this.tray=document.createElement("div"),this.tray.className="decafmud icon-tray",this._input.appendChild(this.tray),this.toolbuttons={},this.infobars=[],this.icons=[],this.toolbar=document.createElement("div"),this.toolbar.className="decafmud toolbar",this.toolbar.setAttribute("role","toolbar");var i=function(){this.className&&(this.className=this.className.replace(" visible",""))};u(this.toolbar,"mousemove",i),u(this.toolbar,"blur",i),this.input=document.createElement("input"),this.input.id="inputelement",this.input.title="MUD Input".tr(this.decaf),this.input.setAttribute("role","textbox"),this.input.setAttribute("aria-label",this.input.title),this.input.type="text",this.input.className="decafmud input",this._input.insertBefore(this.input,this._input.firstChild),this.container.appendChild(this._input),u(this.input,"keydown",function(t){e.handleInput(t)});var s=function(t){e.handleBlur(t)};u(this.input,"blur",s),u(this.input,"focus",s),this.history=[],this.historyPosition=-1;for(var o=0;o<100;o++)this.history[o]="";return this.reset(),u(window,"resize",this.resizeScreenFromEvent.bind(this,"window resize")),"onhelp"in window&&(window.onhelp=function(){return!1}),window.onbeforeunload=this.unloadPageFromEvent.bind(this),this.input.focus(),this};t.prototype.toString=function(){return"<DecafMUD Interface: Simple"+(this.container.id?" (#"+this.container.id+")":"")+">"},t.prototype.toolbutton_id=-1,t.prototype.echo=!0,t.prototype.inpFocus=!1,t.prototype.old_parent=void 0,t.prototype.next_sib=void 0,t.prototype.input=void 0,t.prototype.display=void 0,t.prototype.splash=null,t.prototype.splash_st=null,t.prototype.splash_pgi=null,t.prototype.splash_pgt=null,t.prototype.splash_old=null,t.prototype.scrollButton=void 0,t.supports={tabComplete:!0,multipleOut:!1,fullscreen:!0,editor:!1,splash:!0},t.prototype.initSplash=function(t,e){void 0===t&&(t=0),void 0===e&&(e="Discombobulating interface recipient...".tr(this.decaf)),this.old_y=this.el_display.style.overflowY,this.el_display.style.overflowY="hidden",this.splash=document.createElement("div"),this.splash.className="decafmud splash",this.splash.innerHTML='<h2 class="decafmud heading"><a href="http://decafmud.stendec.me/">DecafMUD</a> <span class="version">v'+s.version+"</span></h2>",this.splash_pg=document.createElement("div"),this.splash_pg.className="decafmud progress",this.splash_pg.setAttribute("role","progressbar"),this.splash_pg.setAttribute("aria-valuemax",100),this.splash_pg.setAttribute("aria-valuemin",0),this.splash_pg.setAttribute("aria-valuenow",t),this.splash_pg.setAttribute("aria-valuetext","{0}%".tr(this.decaf,t)),this.splash_pgi=document.createElement("div"),this.splash_pgi.className="decafmud inner-progress",this.splash_pgi.style.cssText="width:"+t+"%;",this.splash_pg.appendChild(this.splash_pgi),this.splash_pgt=document.createElement("div"),this.splash_pgt.className="decafmud progress-text",this.splash_pgt.innerHTML="{0}%".tr(this.decaf,t),this.splash_pg.appendChild(this.splash_pgt),this.splash.appendChild(this.splash_pg),this.splash_st=document.createElement("div"),this.splash_st.className="decafmud status",this.splash_st.innerHTML=e,this.splash.appendChild(this.splash_st),this.splash_old=document.createElement("div"),this.splash_old.className="decafmud old",this.splash_old.innerHTML="",this.splash.appendChild(this.splash_old),this.container.appendChild(this.splash)},t.prototype.endSplash=function(){this.container.removeChild(this.splash),this.el_display.style.overflowY=this.old_y,this.splash_err=!1,this.splash=this.splash_pg=this.splash_pgi=this.splash_pgt=this.splash_st=null},t.prototype.updateSplash=function(t,e){if(null!==this.splash&&!this.splash_err){if(void 0!==t){var i="{0}%".tr(this.decaf,t);this.splash_pg.setAttribute("aria-valuenow",t),this.splash_pg.setAttribute("aria-valuetext",i),this.splash_pgt.innerHTML=i,this.splash_pgi.style.cssText="width:"+t+"%;"}if(e){var s=document.createElement("div");(i=this.splash_st.innerHTML).endsWith("...")&&(i+="done."),s.innerHTML=i,this.splash_old.insertBefore(s,this.splash_old.firstChild),this.splash_st.innerHTML=e}}},t.prototype.splashError=function(t){return null!==this.splash&&(this.splash_pgt.innerHTML="<b>Error</b>",this.splash_pgi.className+=" error",this.splash_st.innerHTML=t,this.splash_err=!0)},t.prototype.sizeel=void 0,t.prototype.sizetm=void 0,t.prototype.showSize=function(){if(clearTimeout(this.sizetm),void 0!==this.display){void 0===this.sizeel&&(this.sizeel=document.createElement("div"),this.sizeel.className="decafmud note center",this.container.appendChild(this.sizeel));var t=this.display.getSize();this.sizeel.style.cssText="opacity:1",this.sizeel.innerHTML="{0}x{1}".tr(this.decaf,t[0],t[1]);var e=this;this.sizetm=setTimeout(function(){e.hideSize()},500)}},t.prototype.hideSize=function(t){if(clearTimeout(this.sizetm),!0===t){if(void 0!==this.decaf.telopt[s.TN.NAWS])try{this.decaf.telopt[s.TN.NAWS].send()}catch(t){}return this.container.removeChild(this.sizeel),void(this.sizeel=void 0)}this.sizeel.style.cssText="-webkit-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="-moz-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="-o-transition: opacity 0.25s linear;",this.sizeel.style.cssText+="transition: opacity 0.25s linear;";var e=this;setTimeout(function(){e.sizeel.style.opacity=0},0),this.sizetm=setTimeout(function(){e.hideSize(!0)},250)},t.prototype.connected=function(){this.updateIcon(this.ico_connected,"DecafMUD is currently connected.".tr(this.decaf),"","connectivity connected")},t.prototype.connecting=function(){this.updateIcon(this.ico_connected,"DecafMUD is attempting to connect.".tr(this.decaf),"","connectivity connecting")},t.prototype.disconnected=function(){this.updateIcon(this.ico_connected,"DecafMUD is currently disconnected.".tr(this.decaf),"","connectivity disconnected")},t.prototype.unloadPageFromEvent=function(t){return this.decaf.connected?"You are still connected.":void 0},t.prototype.load=function(){this.decaf.require("decafmud.display."+this.decaf.options.display)},t.prototype.reset=function(){this.masked=!1,this.inputCtrl=!1,this.mruIndex=0,this.mruHistory=[],this.mruSize=this.decaf.options.set_interface.mru_size,this.mruTemp=!1,this.hasFocus=!1,this.reqTab=!1,this.wantTab=!1,this.tabIndex=-1,this.tabValues=[],this.buffer="",void 0!==this.input&&this.updateInput(),void 0!==this.display&&this.display.reset()},t.prototype.setup=function(){this.store=this.decaf.store.sub("ui"),this.storage=this.store;var t=this.store.get("toolbar-position","top-left");this.old_tbarpos=t,this.toolbar.className+=" "+t,this.container.insertBefore(this.toolbar,this.container.firstChild);var e=this.decaf.options.display;this.decaf.debugString('Initializing display plugin "'+e+'" in: #'+this.el_display.id,"info"),this.display=new s.plugins.Display[e](this.decaf,this,this.el_display),this.display.id="mud-display",this.decaf.display=this.display,this.goFullOnResize=!1;var i=this.store.get("fullscreen-start",this.decaf.options.set_interface.start_full);this.fsbutton=this.tbNew("Fullscreen".tr(this.decaf),void 0,"Click to enter fullscreen mode.".tr(this.decaf),1,!0,i,void 0,function(t){this.click_fsbutton(t)}),this.logbutton=this.tbNew("Logs".tr(this.decaf),void 0,"Click to open a window containing this session's logs.".tr(this.decaf),0,!0,!1,void 0,function(t){this.showLogs()}),this.ico_connected=this.addIcon("You are currently disconnected.".tr(this.decaf),"","connectivity disconnected"),i?this.enter_fs(!1):this._resizeToolbar()||this.resizeScreen(!1)},t.prototype.showLogs=function(){var t="",e="";if(window.getComputedStyle){for(var i=this.display.display,s=0;i;){if(15<(s+=1))return void alert("Too high count!");if((o=getComputedStyle(i,null)).backgroundColor&&"transparent"!==o.backgroundColor&&"rgba("!==o.backgroundColor.substr(0,5)){t="background-color:"+o.backgroundColor+";";break}if(i===document.body)break;i=i.parentNode}var o;t||(t="background-color:#000;"),t="body{"+t+"color:"+(o=getComputedStyle(this.display.display,null)).color+";}",e="div{font-family:"+o.fontFamily+";font-size:"+o.fontSize+";}"}else t="body{background:#000;color:#C0C0C0;}",e="div{font-family:monospace;}";var n="data:text/html,";n+="<html><head><title>",n+="DecafMUD Session Log".tr(this.decaf),n+="</title><style>"+t+e+"</style></head><body>",n+="<h1>",n+="DecafMUD Session Log".tr(this.decaf),n+="</h2>",n+="<div>"+this.display.display.innerHTML+"</div>",n+="</body></html>";window.open(n,"log-window","width=700,height=400,directories=no,location=no,menubar=no,status=no,toolbar=no,scrollbars=yes")},t.prototype.settings=void 0,t.prototype.showSettings=function(){if(this.settings)return this.settings.parentNode.removeChild(this.settings),this.settings=void 0,this.set_cont=void 0,this.tbPressed(this.stbutton,!1),this.tbTooltip(this.stbutton,"Click to change DecafMUD's settings.".tr(this.decaf)),void this.el_display.setAttribute("tabIndex","0");var t=document.createElement("div");t.className="decafmud window settings",this.toolbarPadding&&(t.style.paddingTop=this.toolbarPadding-5+"px");var e=document.createElement("div");e.className="decafmud window-middle",t.appendChild(e);var i=document.createElement("div");i.className="decafmud window-inner",e.appendChild(i);var s=document.createElement("h2");s.innerHTML="DecafMUD Settings".tr(this.decaf),i.appendChild(s);var o=document.createElement("p");for(var n in o.innerHTML="Use the form below to adjust DecafMUD's settings, then click Apply when you're done.".tr(this.decaf),i.appendChild(o),this.decaf.settings){var r=this.decaf.settings[n],a=document.createElement("fieldset");a.className="decafmud settings";var l=n.substr(0,1).toUpperCase()+n.substr(1);if(void 0!==r._name&&(l=r._name),(p=document.createElement("legend")).innerHTML=l.tr(this.decaf),a.appendChild(p),void 0!==r._desc)(o=document.createElement("p")).innerHTML=r._desc.tr(this.decaf),a.appendChild(o);var c=r._path||"/";for(var h in"/"!==c.substr(-1)&&(c+="/"),r)if("_"!==h.substr(0,1)){o=document.createElement("div");var d=r[h];l=h.substr(0,1).toUpperCase()+h.substr(1);void 0!==d._name&&(l=d._name);var p,u=c+h,f=d._type||"text";if("boolean"!==f)(p=document.createElement("label")).setAttribute("for",u),p.innerHTML=l.tr(this.decaf),o.appendChild(p);if("password"===f)(y=document.createElement("input")).setAttribute("id",u),y.setAttribute("type","password"),o.appendChild(y);else if("boolean"===f){(y=document.createElement("input")).setAttribute("id",u),y.setAttribute("type","checkbox"),o.appendChild(y)}else if("nochance"===f){(y=document.createElement("select")).setAttribute("id",u);var g=document.createElement("option");g.setAttribute("value","true"),g.innerHTML="Yes",y.appendChild(g),(g=document.createElement("option")).setAttribute("value","false"),g.innerHTML="No",y.appendChild(g),o.appendChild(y)}else{(y=document.createElement("input")).setAttribute("id",u),o.appendChild(y)}if(void 0!==d._desc)"boolean"===f?(y=document.createElement("label")).setAttribute("for",u):y=document.createElement("p"),y.innerHTML=d._desc.tr(this.decaf),o.appendChild(y);else if("boolean"===f){var y;(y=document.createElement("label")).setAttribute("for",u),y.innerHTML=l.tr(this.decaf),o.appendChild(y)}a.appendChild(o)}i.appendChild(a)}var b=this.container.offsetHeight-(this._input.offsetHeight+17);this.toolbarPadding&&(b-=this.toolbarPadding-12),b<0&&(b=0),e.style.height=b+"px",this.el_display.setAttribute("tabIndex","-1"),this.container.insertBefore(t,this.el_display),this.settings=t,this.set_cont=i,this.set_mid=e,this.tbPressed(this.stbutton,!0),this.tbTooltip(this.stbutton,"Click to close the settings window.".tr(this.decaf))},t.prototype.tbDelete=function(t){if(void 0!==this.toolbuttons[t]){var e=this.toolbuttons[t];e[0].parentNode.removeChild(e[0]),this.toolbuttons[t]=void 0,this._resizeToolbar()}},t.prototype.tbText=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";if(!e)throw"Text can't be empty/false/null/whatever.";i[0].innerHTML=e,void 0===i[3]&&(i[3]=e,i[0].title=e)},t.prototype.tbTooltip=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";i[3]=e,i[0].title=e||i[1]},t.prototype.tbEnabled=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";e=!!e,i[5]=e,i[0].setAttribute("aria-disabled",!e),e?i[0].className=i[0].className.replace(" disabled",""):/disabled/.test(i[0].className)||(i[0].className+=" disabled")},t.prototype.tbPressed=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";e=!!e,i[6]=e,i[0].setAttribute("aria-pressed",e),e?/toggle-depressed/.test(i[0].className)&&(i[0].className=i[0].className.replace(" toggle-depressed"," toggle-pressed")):/toggle-pressed/.test(i[0].className)&&(i[0].className=i[0].className.replace(" toggle-pressed"," toggle-depressed"))},t.prototype.tbClass=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";var s=i[7];i[7]=e,void 0!==s&&(i[0].className=i[0].className.replace(" "+s,"")),e&&(i[0].className+=" "+e)},t.prototype.tbIcon=function(t,e){var i=this.toolbuttons[t];if(void 0===i)throw"Invalid button ID.";i[2]=e,i[0].style.cssText=e?(/ icon/.test(i[0].className)||(i[0].className+=" icon"),"background-image: url("+e+");"):(i[0].className=i[0].className.replace(" icon",""),"")},t.prototype.tbNew=function(t,e,i,s,o,n,r,a){if("function"==typeof e){var l=a;a=e,e=i,i=s,s=o,o=n,n=r,r=l}var c=++this.toolbutton_id,h=document.createElement("a");if(h.id=this.container.id+"-toolbar-button-"+c,h.className="decafmud button toolbar-button",r&&(h.className+=" "+r),1===s&&(h.className+=" toggle "+(n?"toggle-pressed":"toggle-depressed")),h.innerHTML=t,h.title=i||t,!1!==o&&(o=!0),o||(h.className+=" disabled"),h.setAttribute("tabIndex","0"),h.setAttribute("role","button"),h.setAttribute("aria-disabled",!o),1===s&&h.setAttribute("aria-pressed",n),e&&(h.style.cssText="background-image: url("+e+");",h.className+=" icon"),a){var d=this,p=function(t){if("keydown"!==t.type||13===t.keyCode){var e=d.toolbuttons[c];!0===e[5]&&(a.call(d,t),t.type&&"keydown"!==t.type&&e[0].blur())}};u(h,"click",p),u(h,"keydown",p)}return u(h,"focus",function(t){this.parentNode&&/toolbar/.test(this.parentNode.className)&&(this.parentNode.setAttribute("aria-activedescendant",this.id),this.parentNode.className+=" visible")}),u(h,"blur",function(t){this.parentNode&&/toolbar/.test(this.parentNode.className)&&(this.parentNode.getAttribute("aria-activedescendant")===this.id&&this.parentNode.setAttribute("aria-activedescendant",""),this.parentNode.className=this.parentNode.className.replace(" visible",""))}),this.toolbuttons[c]=[h,t,e,i,s,o,n,r,a],h.setAttribute("button-id",c),this.toolbar.appendChild(h),this._resizeToolbar(),c},t.prototype.toolbarPadding=void 0,t.prototype._resizeToolbar=function(){var t=this.store.get("toolbar-position","top-left"),e=this.store.get("toolbar-always",2),i=this.toolbar.style.cssText,s=!1;this.old_tbarpos!==t&&(this.toolbar.className=this.toolbar.className.replace(" "+this.old_tbarpos," "+t),i="top-left"===this.old_tbarpos||"top-right"===this.old_tbarpos?i.replace(/top:[\s\-0-9a-z]+;/g,""):"left"===this.old_tbarpos?i.replace(/left:[\s\-0-9a-z]+;/g,""):i.replace(/right:[\s\-0-9a-z]+;/g,""),this.old_tbarpos=t),e=0!==e&&(1===e||-1!==this.container.className.indexOf("fullscreen")),-1===this.toolbar.className.indexOf(" always-on")&&e?this.toolbar.className+=" always-on":-1===this.toolbar.className.indexOf(" always-on")||e||(this.toolbar.className=this.toolbar.className.replace(" always-on","")),/ always-on/.test(this.toolbar.className)&&/ top-(?:left|right)/.test(this.toolbar.className)?(this.settings&&this.toolbarPadding!==this.toolbar.clientHeight&&(this.settings.style.paddingTop=this.toolbar.clientHeight-5+"px"),this.display&&this.toolbarPadding!==this.toolbar.clientHeight?(this.display.shouldScroll(),this.el_display.style.paddingTop=this.toolbar.clientHeight+"px",this.toolbarPadding=this.toolbar.clientHeight,this.resizeScreen(!1,!0),this.display.doScroll(),s=!0):this.toolbarPadding=this.toolbar.clientHeight):void 0!==this.toolbarPadding&&(this.settings&&(this.settings.style.paddingTop=""),this.display&&(this.display.shouldScroll(),this.el_display.style.paddingTop="0px",this.toolbarPadding=void 0,this.resizeScreen(!1,!0),this.display.doScroll(),s=!0));var o=-1*(this.toolbar.clientWidth-15),n=-1*(this.toolbar.clientHeight-12);return i=/ left/.test(this.toolbar.className)?i.replace(/left:[\s\-0-9a-z]+;/g,"")+"left:"+o+"px;":/ right/.test(this.toolbar.className)?i.replace(/right:[\s\-0-9a-z]+;/g,"")+"right:"+o+"px;":i.replace(/top:[\s\-0-9a-z]+;/g,"")+"top:"+n+"px;",this.toolbar.style.cssText=i,s},t.prototype.showScrollButton=function(){if(void 0===this.scrollButton){var t=document.createElement("div"),e=this;t.className="button scroll-button",t.setAttribute("tabIndex",0),t.innerHTML="More".tr(this.decaf);var i=function(t){"keydown"==t.type&&13!==t.keyCode||e.display.scrollNew()};u(t,"click",i),u(t,"keydown",i),this.scrollButton=t,this.container.appendChild(t),t.style.cssText="bottom:"+(this._input.offsetHeight+12)+"px"}},t.prototype.hideScrollButton=function(){void 0!==this.scrollButton&&(this.scrollButton.parentNode.removeChild(this.scrollButton),this.scrollButton=void 0)},t.prototype.infoBar=function(t,e,i,s,o,n,r){if("number"==typeof e){var a=i;i=e,e=a}void 0===e&&(e="info"),void 0===i&&(i=0);var l={text:t,class:e,timeout:i,icon:s,buttons:o,click:n,close:r};this.infobars.push(l),void 0===this.ibar&&this.createIBar()},t.prototype.immediateInfoBar=function(t,e,i,s,o,n,r){return void 0===this.ibar&&(this.infoBar(t,e,i,s,o,n,r),!0)};var l=function(t,e,i){var s=document.createElement("a");s.className="button",s.setAttribute("href","#"),s.setAttribute("onclick","return false;"),s.innerHTML=e[0],u(s,"click",function(t){return i.closeIBar(!0),setTimeout(function(){e[1].call(i,t)},0),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1}),t.appendChild(s)};t.prototype.createIBar=function(){var e=this,i=this.infobars[0],s=document.createElement("div");s.setAttribute("role","alert"),s.className="decafmud infobar "+i.class,s.innerHTML=i.text,s.style.cssText="top: -26px;",void 0!==i.click&&(s.className+=" clickable",s.setAttribute("tabIndex","0"));var t=function(t){void 0===t||"keydown"===t.type&&13!==t.keyCode&&27!==t.keyCode||("click"!==t.type||i.click)&&(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),e.closeIBar(!0),"keydown"!==t.type||27!==t.keyCode?i.click&&i.click.call(e,t):i.close&&i.close.call(e,t))};u(s,"click",t),u(s,"keydown",t);var o=document.createElement("div");o.innerHTML="X",o.className="close",o.setAttribute("tabIndex","0");var n=function(t){void 0===t||"keydown"===t.type&&13!==t.keyCode||(e.closeIBar(!0),i.close&&i.close.call(e,t),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation())};if(u(o,"click",n),u(o,"keydown",n),s.insertBefore(o,s.firstChild),i.buttons){var r=document.createElement("div");r.className="btncont";for(var a=0;a<i.buttons.length;a++)l(r,i.buttons[a],this);s.insertBefore(r,o)}this.ibar=s,i.el=s,this.container.insertBefore(s,this.container.firstChild),setTimeout(function(){var t=0;window.getComputedStyle?t=parseInt(getComputedStyle(s,null).paddingTop):s.currentStyle&&(t=parseInt(s.currentStyle.paddingTop)),e.toolbarPadding&&(t+=e.toolbarPadding-10),s.style.cssText="background-position: 5px "+t+"px;padding-top: "+t+"px;-webkit-transition: top 0.1s linear;-moz-transition: top 0.1s linear;-o-transition: top 0.1s linear;transition: top 0.1s linear; top: inherit",i.icon&&(s.style.cssText+='background-image: url("'+i.icon+'")')},0),0<i.timeout&&(this.ibartimer=setTimeout(function(){e.closeIBar()},1e3*i.timeout))},t.prototype.closeIBar=function(t){if(void 0!==this.ibar)if(clearTimeout(this.ibartimer),t)this.ibar.parentNode.removeChild(this.ibar),delete this.ibar,this.infobars.shift(),0<this.infobars.length&&this.createIBar();else{this.ibar.style.cssText+="-webkit-transition: opacity 0.25s linear;-moz-transition: opacity 0.25s linear;-o-transition: opacity 0.25s linear;transition: opacity 0.25s linear; opacity: 0";var e=this;this.ibartimer=setTimeout(function(){e.closeIBar(!0)},250)}},t.prototype.addIcon=function(t,e,i,s,o){var n=document.createElement("div");n.className="decafmud status-icon "+i+(s?" icon-click":""),n.innerHTML=e,n.setAttribute("title",t),n.setAttribute("role","status"),n.setAttribute("aria-label",t),(s||o)&&n.setAttribute("tabIndex","0");for(var r=this.icons.push([n,s,o])-1,a=0;a<this.icons.length;a++)this.icons[a][0].style.cssText="right:"+21*(this.icons.length-a-1)+"px";this.tray.appendChild(n);var l=this;return s&&u(n,"click",function(t){s.call(l,t)}),s&&!o&&u(n,"keydown",function(t){13===t.keyCode&&s.call(l,t)}),o&&u(n,"keydown",function(t){o.call(l,t)}),this._resizeTray(),r},t.prototype.delIcon=function(t){if(t<0||t>=this.icons.length)throw"Invalid index for icon!";var e=this.icons[t][0];this.icons.splice(t,1),this._input.removeChild(e);for(var i=0;i<this.icons.length;i++)this.icons[i].style.cssText="right:"+21*(this.icons.length-i-1)+"px";this._resizeTray()},t.prototype.updateIcon=function(t,e,i,s){if(t<0||t>=this.icons.length)throw"Invalid index for icon!";var o=this.icons[t],n=o[1];o[2];o=o[0],s&&(o.className="decafmud status-icon "+s+(n?" icon-click":"")),i&&(o.innerHTML=i),e&&(o.setAttribute("title",e),o.setAttribute("aria-label",e))},t.prototype._resizeTray=function(){var t=this.tray.clientWidth;this._input.style.cssText="padding-right:"+t+"px"},t.prototype.click_fsbutton=function(t){-1===this.container.className.indexOf("fullscreen")?this.enter_fs():this.exit_fs()},t.prototype.oldscrollX=void 0,t.prototype.oldscrollY=void 0,t.prototype.old_children=[],t.prototype.old_display=[],t.prototype.enter_fs=function(t){if(-1===this.container.className.indexOf("fullscreen")){var e=this.inpFocus;this.display&&this.display.shouldScroll(!1),this.oldscrollY=window.scrollY,this.oldscrollX=window.scrollX,this.old_parent=this.container.parentNode,this.next_sib=this.container.nextElementSibling,void 0===this.next_sib&&this.container.nextSibling&&this.container.nextSibling.nodeType==this.container.nodeType&&(this.next_sib=this.container.nextSibling),this.old_parent.removeChild(this.container),this.container.className+=" fullscreen",this.tbPressed(this.fsbutton,!0),this.tbTooltip(this.fsbutton,"Click to exit fullscreen mode.".tr(this.decaf));for(var i=0;i<document.body.children.length;i++){var s=document.body.children[i];"_firebugConsole"!==s.id&&0!==s.id.indexOf("DecafFlashSocket")&&(this.old_children.push(s),this.old_display.push(s.style.display),s.style.display="none")}this.old_body_over=document.body.style.overflow,f||(document.body.style.overflow="hidden"),document.body.appendChild(this.container),window.scroll(0,0),this._resizeToolbar(),this.resizeScreen(t,!1),!1!==t&&this.showSize(),e&&this.input.focus(),this.display&&this.display.doScroll()}},t.prototype.exit_fs=function(){if(void 0!==this.old_parent){var t=this.inpFocus;this.display&&this.display.shouldScroll(!1),this.container.parentNode.removeChild(this.container);for(var e=0;e<this.old_children.length;e++){this.old_children[e].style.display=this.old_display[e]}this.old_children=[],this.old_display=[];var i=this.container.className.split(" ");for(e=0;e<i.length;)"fullscreen"!==i[e]?e++:i.splice(e,1);this.container.className=i.join(" "),this.tbPressed(this.fsbutton,!1),this.tbTooltip(this.fsbutton,"Click to enter fullscreen mode.".tr(this.decaf)),void 0!==this.next_sib&&null!==this.next_sib?this.old_parent.insertBefore(this.container,this.next_sib):this.old_parent.appendChild(this.container),document.body.style.overflow=this.old_body_over,window.scroll(this.oldscrollX,this.oldscrollY),this._resizeToolbar(),this.showSize(),t&&this.input.focus(),this.display&&this.display.doScroll()}},t.prototype.old_height=-1,t.prototype.old_width=-1,t.prototype.old_fs=!1,t.prototype.goFullOnResize=!0,t.prototype.resizeScreen=function(t,e){if(this.goFullOnResize){var i=!0===window.fullScreen;if(i||(window.outerHeight?i=window.screen.height-window.outerHeight<=5:window.innerHeight&&(i=window.screen.height-window.innerHeight<=5)),i&&!this.old_fs)return this.old_fs=i,void this.enter_fs();if(!i&&this.old_fs)return this.old_fs=i,void this.exit_fs();this.old_fs=i}if(!0===e||this.old_height!==this.container.offsetHeight||this.old_width!==this.container.offsetWidth){this.old_height=this.container.offsetHeight,this.old_width=this.container.offsetWidth;var s=this.old_height-(this._input.offsetHeight+17);this.toolbarPadding&&(s-=this.toolbarPadding-12),s<0&&(s=0),this.settings&&(this.set_mid.style.height=s+"px"),this.toolbarPadding&&(s-=12)<0&&(s=0),this.el_display.style.height=s+"px",!0!==e&&this.display&&this.display.scroll(),this.scrollButton&&(this.scrollButton.style.cssText="bottom:"+(this._input.offsetHeight+12)+"px"),!1!==t&&this.showSize()}},t.prototype.resizeScreenFromEvent=function(t,e){this.resizeScreen(!0,!1)},t.prototype.displayInput=function(t){this.display&&this.echo&&this.display.message('<span class="command">'+t+"</span>","user-input",!1)},t.prototype.localEcho=function(t){t!==this.echo&&(this.echo=t,this.updateInput())},t.prototype.displayKey=function(t){t.altKey||t.ctrlKey||t.metaKey||(64<t.keyCode&&t.keyCode<91||47<t.keyCode&&t.keyCode<58||185<t.keyCode&&t.keyCode<193||218<t.keyCode&&t.keyCode<223)&&this.input.focus()},t.prototype.handleInputPassword=function(t){13===t.keyCode&&(this.inpFocus=!0,this.decaf.sendInput(this.input.value),this.input.value="")},t.prototype.saveInputInHistory=function(){if(txt=this.input.value,""!=txt&&txt!=this.history[0]){var t=-1;for(i=0;i<this.history.length;i++)if(this.history[i]==txt){t=i;break}for(-1==t&&(t=this.history.length-1),i=t;0<i;i--)this.history[i]=this.history[i-1];this.history[0]=txt}},t.prototype.inputModified=function(){return txt=this.input.value,-1==this.historyposition?""!==txt:txt!==this.history[this.historyPosition]},t.prototype.loadInput=function(){-1==this.historyPosition?this.input.value="":(this.input.focus(),this.input.value=this.history[this.historyPosition])},t.prototype.parseInput=function(t){lines=t.split(";;");for(var e=0,i=lines.length;e<i;e++)this.decaf.sendInput(lines[e])},t.prototype.handleInput=function(t){"keydown"===t.type&&(112!=t.keyCode&&116!==t.keyCode||t.preventDefault(),13===t.keyCode?(this.parseInput(this.input.value),this.saveInputInHistory(),this.historyPosition=0,this.decaf.options.set_interface.repeat_input||(this.input.value=""),this.input.select()):void 0!==window.tryExtraMacro&&tryExtraMacro(this.decaf,t.keyCode)?t.preventDefault?t.preventDefault():t.returnValue=!1:33===t.keyCode?this.display&&this.display.scrollUp&&(this.display.scrollUp(),t.preventDefault()):34===t.keyCode?this.display&&this.display.scrollDown&&(this.display.scrollDown(),t.preventDefault()):40==t.keyCode?(this.inputModified()&&(this.historyPosition=-1),-1==this.historyPosition?this.saveInputInHistory():0==this.historyPosition?this.historyPosition=-1:this.historyPosition=this.historyPosition-1,this.loadInput()):38==t.keyCode?(this.inputModified()&&(this.historyPosition=-1),-1==this.historyPosition?""==this.input.value?this.historyPosition=0:(this.saveInputInHistory(),this.historyPosition=1):this.historyPosition<this.history.length-1&&(this.historyPosition=this.historyPosition+1),this.loadInput()):8==t.keyCode&&!0===t.shiftKey&&(this.input.value=""))},t.prototype.handleBlur=function(t){var e=this.input,i=this.decaf.options.set_interface.blurclass;if("blur"===t.type){""===e.value&&(e.className+=" "+i);var s=this;setTimeout(function(){s.settings&&(s.settings.style.top="0px",s.set_mid.style.overflowY="scroll")},100),this.inpFocus=!1}else if("focus"===t.type){for(var o=e.className.split(" "),n=[],r=0;r<o.length;r++)o[r]!==i&&n.push(o[r]);if(e.className=n.join(" "),this.settings){var a=.5*this.settings.clientHeight*-1;this.settings.style.top=a+"px",this.set_mid.style.overflowY="hidden"}this.inpFocus=!0}},t.prototype.updateInput=function(t){if(this.input){var e,i=this.inpFocus,s=this,o=this.input;if(e="TEXTAREA"===this.input.tagName?"text":o.type,!0===t||!(!this.echo&&"password"===e||this.echo&&"password"!==e)){var n,r=o.className,a=o.getAttribute("style"),l=o.id,c=o.parentNode;if(void 0===(n=o.nextElementSibling)&&o.nextSibling&&o.nextSibling.nodeType===o.nodeType&&(n=o.nextSibling),this.echo){var h=1;this.inp_buffer&&(h=this.inp_buffer.substr_count("\n")+1),1===h?(d=document.createElement("input")).type="text":(d=document.createElement("textarea"),f?d.setAttribute("rows",h-1):d.setAttribute("rows",h)),r&&(d.className=r),a&&d.setAttribute("style",a),this.inp_buffer&&(d.value=this.inp_buffer),c.removeChild(o),delete this.input,l&&(d.id=l),n?c.insertBefore(d,n):c.appendChild(d),this.input=d,u(d,"keydown",function(t){s.handleInput(t)})}else{var d;this.inp_buffer=o.value,(d=document.createElement("input")).type="password",r&&(d.className=r),a&&d.setAttribute("style",a),c.removeChild(o),delete this.input,l&&(d.id=l),n?c.insertBefore(d,n):c.appendChild(d),this.input=d,u(d,"keydown",function(t){s.handleInputPassword(t)})}this.inpFocus=i;var p=function(t){s.handleBlur(t)};u(this.input,"blur",p),u(this.input,"focus",p),this.inpFocus&&setTimeout(function(){s.input.select(),s.input.focus()},1)}}},s.plugins.Interface.simple=t}(DecafMUD)},function(t,e){
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 */
var n,o,i,g,y,b,v,m,_,S,C;n=DecafMUD,o=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):(e="on"+e,t.attachEvent?t.attachEvent(e,i):t[e]=i)},i=function(t,e,i){this.decaf=t,this.ui=e,this._display=i,this.display=document.createElement("div"),this.display.className="decafmud display "+this.decaf.options.set_display.fgclass+"7",this._display.appendChild(this.display);var s=this;o(this._display,"scroll",function(t){s.onScroll()}),o(this._display,"mousedown",function(t){2===t.which&&s.decaf.store.get("ui/middle-click-scroll",!1)&&(s.scroll(),t.cancelBubble&&(t.cancelBubble=!0),t.preventDefault())}),(this.decaf.loaded_plugs.display=this).splash=this.display.innerHTML,this.orig_title=null,this.clear(),this.message('<br><a href="http://decafmud.stendec.me">DecafMUD</a> v'+n.version+' by Stendec &lt;<a href="mailto:stendec365@gmail.com">stendec365@gmail.com</a>&gt;<br>'),0<this.splash.length&&this.message(this.splash+"<br>")},g=parseInt("00000001",2),y=parseInt("00000010",2),b=parseInt("00000100",2),v=parseInt("00001000",2),m=parseInt("00010000",2),_=parseInt("00100000",2),S=parseInt("01000000",2),C=parseInt("10000000",2),i.prototype.state=0,i.prototype.c_fg=7,i.prototype.c_bg=0,i.prototype.c_fnt=0,i.prototype.readyClear=!1,i.prototype.endSpace=!1,i.prototype.scrollTime=null,i.prototype.willScroll=!1,i.prototype.vt100Warning=!1,i.prototype.mxp=!1,i.prototype.clear=function(){clearTimeout(this.scrollTime),this.display.innerHTML="",this.reset(),this.inbuf=[],this.outbuf=[]},i.prototype.reset=function(){this.state=0,this.c_fg=7,this.c_bg=0,this.c_fnt=0,this.readyClear=!1,this.endSpace=!1},i.prototype.sbw=void 0,i.prototype.scrollbarWidth=function(){if(this.sbw)return this.sbw;var t=this._display.style.overflowY;return this._display.style.overflowY="scroll",this._display.offsetWidth>this._display.clientWidth?(this.sbw=this._display.offsetWidth-this._display.clientWidth,this.sbw):(this._display.style.overflowY=t,15)},i.prototype.cz=void 0,i.prototype.charSize=function(){if(this.cz)return this.cz;var t=document.createElement("span");t.innerHTML="W",this.display.appendChild(t);var e=t.offsetWidth,i=t.offsetHeight;return this.display.removeChild(t),this.cz=[e,i],this.cz},i.prototype.getSize=function(){var t;t=this.decaf.options.set_display.scrollbarwidth?this.decaf.options.set_display.scrollbarwidth:this.scrollbarWidth();var e=this._display.clientWidth-t,i=this._display.clientHeight,s=this.charSize(),o=s[0],n=s[1];return[Math.floor(e/o)+1,Math.floor(i/n)]},i.prototype.handleData=function(t){this.inbuf.push(t),this.processData()},i.prototype.processData=function(){if(!(this.inbuf.length<1)){var t=this.inbuf.join("");this.inbuf=[];for(var e=n.ESC;0<t.length;){var i=t.indexOf(e);if(-1===i){this.outbuf.push(t.replace(/</g,"&lt;"));break}0<i&&(this.readyClear=!1,this.outbuf.push(t.substr(0,i).replace(/</g,"&lt;")),t=t.substr(i));var s=this.readANSI(t);if(!1===s){this.inbuf.push(t);break}t=s}t=this.outbuf.join(""),this.outbuf=[],this.outColor(!1),this.needline=!t.endsWith("\n"),this._display.setAttribute("aria-busy",!0);var o=document.createElement("span");o.innerHTML=t.replace(/\n\r?/g,"<br>").replace(/> /g,">&nbsp;").replace(/ ( +)/g,function(t){return 2===t.length?" &nbsp;":" "+new Array(t.length-1).join("&nbsp;")+" "}),this.shouldScroll(),this.display.appendChild(o),this.doScroll()}},i.prototype.readANSI=function(t){if(t.length<2)return!1;if("["==t.charAt(1))return-1!==(e=t.substr(2).search(/[\x40-\x7E]/))&&(e+=2,this.handleAnsiCSI(t.substr(2,e-1)),t.substr(e+1));if("]"!=t.charAt(1))return t.substr(1);var e=t.substr(2).indexOf(n.BEL),i=t.substr(2).indexOf(n.ESC+"\\");return(i<e||-1===e)&&(e=i),-1!==e&&(e+=2,t.substr(e))},i.prototype.handleAnsiCSI=function(t){switch(t.charAt(t.length-1)){case"m":var e=this.state,i=this.c_fg,s=this.c_bg,o=this.c_fnt;1===t.length&&(t="0m");for(var n=t.substr(0,t.length-1).split(";"),r=n.length,a=0;a<r;a++){var l=parseInt(n[a]);if(38===l){if(a++,r<=++a)break;this.c_fg=parseInt(n[a])}else if(39===l)this.c_fg=7;else if(48===l){if(a++,r<=++a)break;this.c_bg=parseInt(n[a])}else{if(29<l&&l<38){this.c_fg=l-30;continue}if(39<l&&l<48){this.c_bg=l-40;continue}if(0===l){this.state=0,this.c_fg=7,this.c_bg=0,this.c_fnt=0;continue}if(1===l){this.state|=g,this.state&=~_;continue}if(2===l)this.state&=~g,this.state|=_;else if(3===l)this.state|=b;else if(4===l)this.state|=m,this.state&=~C;else if(l<7)this.state|=v;else if(7===l)this.state|=y;else{if(8===l)continue;9===l?this.state|=S:l<20?this.c_fnt=l-10:21===l?(this.state|=C,this.state&=~m):22===l?this.state&=~(g|_):23===l?this.state&=~b:24===l?this.state&=~(m|C):25===l?this.state&=~v:27===l?this.state&=~y:29===l?this.state&=~S:49===l?this.c_bg=0:89<l&&l<98?(this.state|=g,this.state&=~_,this.c_fg=l-90):99<l&&l<108&&(this.c_bg=l-92)}}}return this.state===e&&i===this.c_fg&&s===this.c_bg&&o===this.c_fnt||this.outColor(),void(this.readyClear=!1);case"@":case"C":var c=1;return 1<t.length&&(c=parseInt(t.substr(0,t.length-1))),this.outbuf.push(new Array(c+1).join(" ")),void(this.readyClear=!1);case"E":return(c=1)<t.length&&(c=parseInt(t.substr(0,t.length-1))),this.outbuf.push(new Array(c+1).join("\n")),void(this.readyClear=!1);case"H":return void(1===t.length&&(this.readyClear=!0));case"J":var h=0;return 1<t.length&&(h=parseInt(t.substr(0,t.length-1))),(0===h&&this.readyClear||2===h)&&this.clear(),void(this.readyClear=!1);case"K":if(h=0,1<t.length&&(h=parseInt(t.substr(0,t.length-1))),2===h){var d=!1;if(0<this.outbuf.length)for(;0<this.outbuf.length;){var p=this.outbuf[this.outbuf.length-1];if(-1!==p.lastIndexOf("\n")){d=!0,this.outbuf[this.outbuf.length-1]=p.substr(0,p.lastIndexOf("\n")+1);break}this.outbuf.pop()}if(!d)for(;0<this.display.childElementCount;){var u=this.display.children[this.display.childElementCount-1],f=u.innerHTML;if(-1!==f.lastIndexOf("<br>")){d=!0,u.innerHTML=f.substr(0,f.lastIndexOf("<br>")+4);break}this.display.removeChild(u)}}else 1===h&&this.decaf.debugString("ANSI Sequence ESC ["+t+" -- TODO: Mode 1");return}-1!=="ABCDEFGHJKSTfnsulh".indexOf(t.charAt(t.length-1))?this.vt100Warning||(this.decaf.debugString("Notice: This display handler only provides a subset of VT100, and doesn't handle cursor movement commands."),this.vt100Warning=!0):this.decaf.debugString("Unhandled ANSI Sequence: ESC ["+t)},i.prototype.outColor=function(t,e){var i,s=this.c_fg,o=this.c_bg,n=this.state,r=this.decaf.options.set_display;if(n&g&&s<8&&(s+=8),i=(!1!==t?"</span>":"")+'<span class="',n&b&&(i+="italic "),n&v&&(i+="blink "),n&m&&(i+="underline "),n&C&&(i+="doubleunderline "),n&_&&(i+="faint "),n&S&&(i+="strike "),n&y&&(o=s,s=this.c_bg),0!==this.c_fnt&&(i+=r.fntclass+this.c_fnt+" "),7!==s&&(i+=r.fgclass+s+" "),0!==o&&(i+=r.bgclass+o),i+='">',!0===e)return i;this.outbuf.push(i)},i.prototype.message=function(t,e,i){void 0===e&&(e="message");var s=document.createElement("span");this.needline&&!1!==i&&(s.innerHTML="<br>"),this.needline=!1,s.innerHTML+=t.replace(/ ( +)/g,function(t){return 2===t.length?" &nbsp;":" "+new Array(t.length-1).join("&nbsp;")+" "})+"<br>",this.shouldScroll(),this.display.appendChild(s),this.doScroll()},i.prototype.shouldScroll=function(t){if(void 0===this.willScroll&&"hidden"!==this._display.style.overflowY&&(this.willScroll=this._display.scrollTop>=this._display.scrollHeight-this._display.offsetHeight,!1!==t&&!1===this.willScroll&&!this.scrollTarget)){var e=document.createElement("hr");e.className="scroll-point",this.scrollTarget=e,this.display.appendChild(e),this.ui&&this.ui.showScrollButton&&this.ui.showScrollButton()}},i.prototype.doScroll=function(){var t=this;clearTimeout(this.scrollTime),this.willScroll?this.scrollTime=setTimeout(function(){t.scrollTarget&&(t.scrollTarget.parentNode.removeChild(t.scrollTarget),t.scrollTarget=void 0),t._display.setAttribute("aria-busy",!1),t.scroll(),t.willScroll=void 0},5):this.scrollTime=setTimeout(function(){t._display.setAttribute("aria-busy",!1),t.willScroll=void 0},5)},i.prototype.scrollNew=function(){if(this.scrollTarget){var t=this.scrollTarget.offsetTop;t>this._display.scrollTop?this._display.scrollTop=t:this.scroll()}},i.prototype.scroll=function(){"hidden"!==this._display.style.overflowY&&(this._display.scrollTop=this._display.scrollHeight)},i.prototype.onScroll=function(){void 0!==this.scrollTarget&&this._display.scrollTop>=this._display.scrollHeight-this._display.offsetHeight&&(this.scrollTarget&&(this.scrollTarget.parentNode.removeChild(this.scrollTarget),this.scrollTarget=void 0),this.ui&&this.ui.hideScrollButton&&this.ui.hideScrollButton())},i.prototype.scrollUp=function(){var t=this._display.scrollTop-this._display.clientHeight;t<0&&(t=0),this._display.scrollTop=t},i.prototype.scrollDown=function(){var t=this._display.scrollTop+this._display.clientHeight;this._display.scrollTop=t},i.prototype.tags={VAR:{default:!0,secure:!0,want:!0,open_tag:"",close_tag:"",arg_order:["name","desc","private","publish","delete","add","remove"],arguments:{name:"",desc:"",private:!1,publish:!0,delete:!1,add:!0,remove:!1},handler:function(){}},B:{default:!0,secure:!1,want:!1,open_tag:'<b class="mxp">',close_tag:"</b>"},BOLD:"B",STRONG:"B",I:{default:!0,secure:!1,want:!1,open_tag:'<i class="mxp">',close_tag:"</i>"},ITALIC:"I",EM:"I",U:{default:!0,secure:!1,want:!1,open_tag:'<u class="mxp">',close_tag:"</u>"},UNDERLINE:"U",S:{default:!0,secure:!1,want:!1,open_tag:'<s class="mxp">',close_tag:"</s>"},STRIKEOUT:"S",COLOR:{default:!0,secure:!1,want:!1,open_tag:'<span class="mxp mxp-color" style="color:&fore;;background-color:&back;">',close_tag:"</span>",arg_order:["fore","back"],arguments:{fore:"inherit",back:"inherit"}},C:"COLOR",HIGH:{default:!0,secure:!1,want:!0}},n.plugins.Display.standard=i},function(t,e){
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 */
!function(t){var e={"Â¤":"â‚¬","Â¦":"Å ","Â¨":"Å¡","Â´":"Å½","Â¸":"Å¾","Â¼":"Å’","Â½":"Å“","Â¾":"Å¸"},i="[",s="[",o={};for(var n in e)i+=n,s+=e[n],o[e[n]]=n;i=new RegExp(i+"]","g"),s=new RegExp(s+"]","g");t.plugins.Encoding.iso885915={proper:"ISO-8859-15",decode:function(t){return[t.replace(i,function(t){return e[t]}),""]},encode:function(t){return t.replace(s,function(t){return o[t]})}}}(DecafMUD)},function(t,e){
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 * Licensed under the MIT license.
 */
var i,s;i=DecafMUD,(s=function(t){this.decaf=t}).prototype.host=void 0,s.prototype.port=void 0,s.prototype.ssl=void 0,s.prototype.connected=!1,s.prototype.ready=!1,s.prototype.websocket=null,s.prototype.setup=function(){if("WebSocket"in window)return this.ready=!0,void this.decaf.socketReady(this);clearTimeout(this.decaf.timer),this.decaf.error("Unable to create a WebSocket. Does your browser support them? If not, try {0}.".tr(this.decaf,'<a href="http://www.google.com/chrome" target="_blank">Google Chrome</a>'))},s.prototype.connect=function(){this.connected&&this.websocket&&(this.websocket.close(),this.websocket=null);var t=this.port;void 0===t&&(((t=this.decaf.options.set_socket.wsport)<1||65535<t)&&(t=this.decaf.options.set_socket.policyport),void 0===t&&(t=843),this.port=t);var e=this.decaf.options.set_socket.wspath;void 0===e&&(e="port_"+this.decaf.options.port);var i=this.host;void 0===i&&((i=this.decaf.options.host)||(i=document.location.host),this.host=i);var s=this.ssl;void 0===s&&(void 0===(s=this.decaf.options.set_socket.ssl)&&(s=!1),this.ssl=s);var o="ws"+(s?"s":"")+"://"+i+":"+t+"/"+e;this.decaf.debugString("WebSocket Connection String: "+o),this.websocket=new WebSocket(o,"binary"),this.websocket.onopen=this.onOpen.bind(this,this.websocket),this.websocket.onclose=this.onClose.bind(this,this.websocket),this.websocket.onmessage=this.onMessage.bind(this,this.websocket)},s.prototype.close=function(){this.connected=!1,this.websocket&&(this.websocket.close(),this.websocket=null)},s.prototype.assertConnected=function(){if(!this.connected||!this.websocket)throw"DecafMUD is not currently connected."},s.prototype.write=function(t){this.assertConnected();for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=t.charCodeAt(i);var s=new Uint8Array(e).buffer;this.websocket.send(s)},s.prototype.onOpen=function(t,e){1===t.readyState&&(this.connected=!0,this.decaf.socketConnected())},s.prototype.onClose=function(t,e){this.connected&&(this.connected=!1,this.decaf.socketClosed(),this.websocket==t&&(this.websocket=null))},s.prototype.onMessage=function(t,e){var i=new FileReader;i.onload=function(t){var e,i=new Uint8Array(t.target.result),s="";for(e=0;e<i.length;++e)s+=String.fromCharCode(i[e]);this.decaf.socketData(s)}.bind(this),i.readAsArrayBuffer(e.data)},i.plugins.Socket.websocket=s},function(t,e){
/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec <stendec365@gmail.com>
 */
var i,s;i=DecafMUD,(s=function t(e,i){if(void 0===i&&(i=""),this.path=i+"/",e instanceof t?(this.decaf=e.decaf,e.children.push(this)):this.decaf=e,!(this.children=[])in window)throw"This storage backend can only be used in browsers supporting localStorage.";return this}).prototype.get=function(t,e){var i=window.localStorage[this.path+t];return null==i?e:JSON.parse(i)},s.prototype.set=function(t,e){e="string"==typeof e?'"'+e+'"':JSON.stringify(e),window.localStorage[this.path+t]=e},s.prototype.del=function(t){return delete window.localStorage[this.path+t]},s.prototype.sub=function(t){return new s(this,this.path+t)},s.prototype.keys=function(){for(var t=[],e=window.localStorage.length,i=this.path,s=0;s<e;s++){var o=window.localStorage.key(s);-1!==o.indexOf(i)&&t.push(o.substr(i.length))}return t},s.prototype.change=function(t){var e=this.path,i=this.children.length;this.path=t+"/";for(var s=0;s<i;s++){var o=this.path+this.children[s].path.substr(e.length);o=o.substr(0,o.length-1),this.children[s].change(o)}},i.plugins.Storage.standard=s},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var s;i(0),i(1),i(2),i(3),i(4),i(5),i(6),i(7),i(8);new DecafMUD({host:"waterpoint-wss.the-b.org",autoreconnect:!1,autoconnect:!0,set_socket:{wsport:443,wspath:"/client/websocket",ssl:!0},set_interface:{container:"#wpt-client",connect_hint:!1,repeat_input:!1,start_full:!1},language:"en",encoding:"utf8",socket:"websocket"}),s=void 0,"loading"!=document.readyState?s():document.addEventListener("DOMContentLoaded",s)}]);